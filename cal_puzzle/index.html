<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Puzzle Solutions Viewer</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f8f8f8;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      max-width: 800px;
      width: 100%;
    }
    h1 {
      margin-bottom: 1em;
      text-align: center;
      font-size: 2.5em;
    }
    .date-selectors {
      margin-bottom: 2em;
      display: flex;
      align-items: center;
      gap: 1.5em;
      flex-wrap: wrap;
      justify-content: center;
    }
    label {
      font-size: 1.2em;
      font-weight: bold;
    }
    select {
      padding: 0.8em;
      font-size: 1.2em;
      min-width: 120px;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(7, 100px);
      grid-template-rows: repeat(7, 100px);
      gap: 4px;
      background: #444;
      width: fit-content;
      padding: 15px;
      border-radius: 8px;
    }
    .cell {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      font-weight: bold;
      color: #000;
      border-radius: 6px;
      background: #fff;
    }
    .empty-cell {
      background: #444;
    }
    /* Piece colors */
    .id-1 { background: red; color: white; }
    .id-2 { background: blue; color: white; }
    .id-3 { background: green; color: white; }
    .id-4 { background: yellow; color: black; }
    .id-5 { background: magenta; color: white; }
    .id-6 { background: cyan; color: black; }
    .id-7 { background: grey; color: white; }
    .id-8 { background: orange; color: black; border: 1px solid #ccc; }
    
    /* Mobile responsive adjustments */
    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      .container {
        max-width: 100%;
      }
      h1 {
        font-size: 2em;
        margin-bottom: 0.8em;
      }
      .date-selectors {
        gap: 1em;
        margin-bottom: 1.5em;
      }
      label {
        font-size: 1.1em;
      }
      select {
        padding: 0.6em;
        font-size: 1.1em;
        min-width: 100px;
      }
      .board {
        grid-template-columns: repeat(7, 85px);
        grid-template-rows: repeat(7, 85px);
        gap: 3px;
        padding: 12px;
      }
      .cell {
        font-size: 20px;
      }
      .empty-cell {
        background: #444;
      }
    }
    
    @media (max-width: 480px) {
      .board {
        grid-template-columns: repeat(7, 75px);
        grid-template-rows: repeat(7, 75px);
        gap: 2px;
        padding: 10px;
      }
      .cell {
        font-size: 18px;
      }
      .empty-cell {
        background: #444;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    
    @media (max-width: 360px) {
      .board {
        grid-template-columns: repeat(7, 65px);
        grid-template-rows: repeat(7, 65px);
        gap: 2px;
        padding: 8px;
      }
      .cell {
        font-size: 16px;
      }
      .empty-cell {
        background: #444;
      }
    }
    
    /* Code display responsive adjustments */
    @media (max-width: 768px) {
      #codeDisplay {
        font-size: 0.9em !important;
        padding: 1em !important;
        max-height: 400px !important;
      }
      #showCodeLink {
        font-size: 1em !important;
      }
    }
    
    @media (max-width: 480px) {
      #codeDisplay {
        font-size: 0.85em !important;
        padding: 0.8em !important;
        max-height: 350px !important;
        line-height: 1.3 !important;
      }
      #showCodeLink {
        font-size: 0.95em !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Best puzzle ever</h1>
    <div class="date-selectors">
      <label for="monthSelect">Month: </label>
      <select id="monthSelect">
        <option value="Jan">January</option>
        <option value="Feb">February</option>
        <option value="Mar">March</option>
        <option value="Apr">April</option>
        <option value="May">May</option>
        <option value="Jun">June</option>
        <option value="Jul">July</option>
        <option value="Aug">August</option>
        <option value="Sep">September</option>
        <option value="Oct">October</option>
        <option value="Nov">November</option>
        <option value="Dec">December</option>
      </select>
      
      <label for="daySelect">Day: </label>
      <select id="daySelect">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option value="29">29</option>
        <option value="30">30</option>
        <option value="31">31</option>
      </select>
    </div>
    <div id="board" class="board"></div>
    
    <div class="code-section" style="margin-top: 2em; text-align: center;">
      <a href="#" id="showCodeLink" style="color: #666; text-decoration: none; font-size: 1.1em;">Show source code</a>
      <pre id="codeDisplay" style="display: none; background: #f5f5f5; padding: 1.5em; border-radius: 6px; text-align: left; overflow-x: auto; margin-top: 1em; font-size: 1em; max-height: 500px; overflow-y: auto; line-height: 1.4; border: 1px solid #ddd;"><code class="language-python"></code></pre>
    </div>
  </div>

  <script>
    const baseBoard = [
      ["Jan", "Feb", "Mar", "Apr", "May", "Jun", ""],
      ["Jul", "Aug", "Sep", "Oct", "Nov", "Dec", ""],
      ["1", "2", "3", "4", "5", "6", "7"],
      ["8", "9", "10", "11", "12", "13", "14"],
      ["15", "16", "17", "18", "19", "20", "21"],
      ["22", "23", "24", "25", "26", "27", "28"],
      ["29", "30", "31", "", "", "", ""],
    ];

    const boardEl = document.getElementById('board');
    const monthSelectEl = document.getElementById('monthSelect');
    const daySelectEl = document.getElementById('daySelect');
    let solutions = {};

    // Initialize empty board
    function drawBoard(solutionGrid = null) {
      boardEl.innerHTML = '';
      for (let r = 0; r < baseBoard.length; r++) {
        for (let c = 0; c < baseBoard[r].length; c++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          const val = baseBoard[r][c];
          if (val) {
            cell.textContent = val;
          } else {
            cell.classList.add('empty-cell');
          }

          if (solutionGrid && solutionGrid[r][c] !== -1) {
            cell.classList.add(`id-${solutionGrid[r][c]}`);
          }
          boardEl.appendChild(cell);
        }
      }
    }

    // Function to update the board based on current month and day selection
    function updateBoard() {
      const month = monthSelectEl.value;
      const day = daySelectEl.value;
      const key = `${month}_${day}`;
      
      if (solutions[key]) {
        drawBoard(solutions[key]);
      } else {
        // If no solution exists for this date, show empty board
        drawBoard();
      }
    }

    // Load solutions.json
    fetch('solutions.json')
      .then(resp => resp.json())
      .then(data => {
        solutions = data;
        // Set default to today's date
        const today = new Date();
        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 
                           'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const currentMonth = monthNames[today.getMonth()];
        const currentDay = today.getDate().toString();
        
        monthSelectEl.value = currentMonth;
        daySelectEl.value = currentDay;
        updateBoard();
      });

    // Add event listeners for both selectors
    monthSelectEl.addEventListener('change', updateBoard);
    daySelectEl.addEventListener('change', updateBoard);

    // Code display functionality
    const showCodeLink = document.getElementById('showCodeLink');
    const codeDisplay = document.getElementById('codeDisplay');
    const codeElement = codeDisplay.querySelector('code');
    let codeLoaded = false;

    showCodeLink.addEventListener('click', (e) => {
      e.preventDefault();
      
      if (!codeLoaded) {
        // Load the code from main.py
        fetch('main.py')
          .then(response => response.text())
          .then(code => {
            codeElement.textContent = code;
            // Trigger syntax highlighting
            Prism.highlightElement(codeElement);
            codeLoaded = true;
            codeDisplay.style.display = 'block';
            showCodeLink.textContent = 'Hide source code';
          })
          .catch(error => {
            console.error('Error loading code:', error);
            codeElement.textContent = 'Error loading source code.';
            codeDisplay.style.display = 'block';
          });
      } else {
        // Toggle display
        if (codeDisplay.style.display === 'none') {
          codeDisplay.style.display = 'block';
          showCodeLink.textContent = 'Hide source code';
        } else {
          codeDisplay.style.display = 'none';
          showCodeLink.textContent = 'Show source code';
        }
      }
    });
  </script>
  
  <!-- Prism.js for syntax highlighting -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
